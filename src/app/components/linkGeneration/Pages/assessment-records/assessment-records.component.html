<div class="min-h-screen bg-gray-50 p-4 sm:p-8">
  <div class="bg-white shadow-xl rounded-xl p-6 sm:p-8">
    <h1
      class="text-2xl sm:text-4xl font-bold mb-4 sm:mb-8 text-gray-900 border-b pb-2 sm:pb-4"
    >
      Assessment Records
    </h1>

    <div
      class="flex flex-wrap sm:flex-nowrap items-center gap-4 sm:gap-6 mb-6 sm:mb-8"
    >
      <!-- Search Bar -->
      <div class="flex-grow">
        <label
          for="search"
          class="block text-sm font-medium text-gray-700 mb-1"
        >
          Search:
        </label>
        <input
          id="search"
          type="text"
          [placeholder]="'Search by ' + selectedFilter"
          [(ngModel)]="searchQuery"
          (input)="onSearch()"
          class="w-full px-4 py-3 border rounded-lg shadow focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700"
        />
      </div>

      <!-- Dropdown for Filters -->
      <div class="w-full sm:w-auto">
        <label
          for="filter"
          class="block text-sm font-medium text-gray-700 mb-1"
        >
          Filter by:
        </label>
        <select
          id="filter"
          name="filter"
          [(ngModel)]="selectedFilter"
          class="w-full px-4 py-2 border rounded-lg shadow focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700"
        >
          <option value="">All</option>
          @for (filter of filterOptions; track $index) {
          <option [value]="filter">
            {{ filter }}
          </option>
          }
        </select>
      </div>

      <!-- Dropdown for Status -->
      <div class="w-full sm:w-auto">
        <label
          for="status"
          class="block text-sm font-medium text-gray-700 mb-1"
        >
          Status:
        </label>
        <select
          id="status"
          name="status"
          [(ngModel)]="selectedStatus"
          class="w-full px-4 py-2 border rounded-lg shadow focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700"
          (change)="onSearch()"
        >
          <option value="">All</option>
          @for (status of statusOptions; track $index) {
          <option [value]="status">
            {{ status }}
          </option>
          }
        </select>
      </div>
    </div>

    <div class="overflow-x-auto rounded-lg">
      <table
        class="min-w-full bg-white border border-gray-300 rounded-lg shadow text-sm sm:text-base"
      >
        <thead class="bg-gray-100">
          <tr>
            <th
              class="px-4 sm:px-6 py-3 text-left text-gray-800 font-semibold border-b"
            >
              Assessment Name
            </th>
            <th
              class="px-4 sm:px-6 py-3 text-left text-gray-800 font-semibold border-b"
            >
              Candidate Name
            </th>
            <th
              class="px-4 sm:px-6 py-3 text-left text-gray-800 font-semibold border-b"
            >
              Candidate Email
            </th>
            <th
              class="px-4 sm:px-6 py-3 text-left text-gray-800 font-semibold border-b"
            >
              Status
            </th>
            <th
              class="px-4 sm:px-6 py-3 text-left text-gray-800 font-semibold border-b"
            >
              URL
            </th>
            <th
              class="px-4 sm:px-6 py-3 text-left text-gray-800 font-semibold border-b"
            >
              Action
            </th>
          </tr>
        </thead>
        <tbody>
          <!-- Loader Row -->
          @if (isLoading) {
          <tr>
            <td colspan="6" class="text-center py-6">
              <div class="flex items-center justify-center">
                <div class="loader"></div>
              </div>
            </td>
          </tr>
          }
          <!-- No Records Row -->
          @if (!isLoading && filteredAssessments.length === 0) {
          <tr>
            <td colspan="6" class="text-center py-6 text-gray-700">
              <b class="text-red-600"> No Assessment Record Found </b>
            </td>
          </tr>
          }
          <!-- Records Rows -->
          @for (assessment of filteredAssessments; track $index) {
          <tr class="hover:bg-gray-50 even:bg-gray-50">
            <td class="px-4 sm:px-6 py-3 border-b text-gray-700">
              {{ assessment.assessmentName }}
            </td>
            <td class="px-4 sm:px-6 py-3 border-b text-gray-700">
              {{ assessment.userName }}
            </td>
            <td class="px-4 sm:px-6 py-3 border-b text-gray-700">
              {{ assessment.email }}
            </td>
            <td class="px-4 sm:px-6 py-3 border-b">
              <span
                [ngClass]="{
                  'text-green-600': assessment.status === 'Active',
                  'text-red-600': assessment.status === 'Expired',
                  'text-yellow-600': assessment.status === 'In Progress',
                  'text-blue-600': assessment.status === 'Completed',
                  'text-gray-600': assessment.status === 'Invalid'
                }"
                class="font-semibold"
              >
                {{ assessment.status || "Unknown" }}
              </span>
            </td>
            <td class="px-4 sm:px-6 py-3 border-b">
              <a href="#" class="text-blue-600 underline hover:text-blue-800">
                {{ assessment.url }}
              </a>
            </td>
            <td class="px-4 sm:px-6 py-3 border-b">
              <app-button
                (click)="invalidateAssessment(assessment)"
                class="px-4 py-2 bg-red-500 text-white font-medium cursor-pointer rounded-lg shadow hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400"
                [ngClass]="{
                  'opacity-50': isInvalidDisabled(assessment),
                  'disabled-button': isInvalidDisabled(assessment)
                }"
              >
                Invalid
              </app-button>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>